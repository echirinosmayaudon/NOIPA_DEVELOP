<%
    boolean noConfigTematica = NoiPAWebAssistenzaUtils.isValid(mailconfigMail,mailconfigNominativo,mailconfigMailHp,linkAmministrazione, listaCategoriaUtenti, listaArea, listaTematica, listaTipologia, ConfigurazioneENUM.TEMATICA);
%>

<c:choose>
	<c:when test="<%= !noConfigTematica %>">
        <p>
            <liferay-ui:message key="noipawebformassistenza.no.area.config" />
        </p>
	</c:when>

	<c:otherwise>
		<p>
			<liferay-ui:message key="noipawebformassistenza.config.tematica" />
		</p>


<liferay-portlet:actionURL portletConfiguration="<%= true %>"
    var="configurationActionURL" />

<liferay-portlet:renderURL portletConfiguration="<%= true %>"
    var="configurationRenderURL" />
<aui:form action="<%= configurationActionURL %>" method="post" name="fm4">

    <aui:input name="<%= Constants.CMD %>" type="hidden"
        value="<%= Constants.UPDATE %>" />

    <aui:input name="redirect" type="hidden"
        value="<%= configurationRenderURL %>" />    
        
        <aui:input name="noipa_type_config" type="hidden" value="tematica" />
        
		<div id="auto-fields-container-tematica">
				<% 
				
				if(listaTematica!=null && listaTematica.size()>0){
					int index = 1;
					for(ConfigurazioneBeanEx bean : listaTematica){
						String key = "ktematica"+index;
						String value = "vtematica"+index;
						String type = "ttematica"+index;
				%>
				<div class="lfr-form-row lfr-form-row-inline">
					<div class="row">
					  <div class="col-md-4"><aui:input label="key-tematica" name="<%=key %>" value="<%=bean.getKey() %>" /></div>
					  <div class="col-md-4"><aui:input label="value-tematica" name="<%=value %>" value="<%=bean.getValue() %>"/></div>
					  <div class="col-md-5">
							<aui:select label="type-tematica" name="<%=type%>" value="<%=bean.getRifKey() %>" >
								<aui:option value=""><liferay-ui:message key="noipawebformassistenza.config.select" /></aui:option>
								<% 
						        for(ConfigurazioneBeanEx beanA : listaArea){
						        	String cuKey = beanA.getKey();
						        	String cuValue = beanA.getValue();
						      	 %>
									<aui:option value="<%=cuValue%>"><%=cuKey%></aui:option>
								<%  }  %>
							</aui:select>
					  </div>
					</div>
				</div>
						
						
					
				<%
					index = index+1;
					}
				} else {
				%>
					<div class="lfr-form-row lfr-form-row-inline">
						<div class="row">
							<div class="col-md-4"><aui:input label="key-tematica" name="ktematica1" /></div>
							<div class="col-md-4"><aui:input label="value-tematica" name="vtematica1" /></div>
							<div class="col-md-5">
								<aui:select label="type-tematica" name="ttematica1" >
								<aui:option value=""><liferay-ui:message key="noipawebformassistenza.config.select" /></aui:option>
								<% 
						        for(ConfigurazioneBeanEx beanA : listaArea){
						        	String cuKey = beanA.getKey();
						        	String cuValue = beanA.getValue();
						      	 %>
									<aui:option value="<%=cuValue%>"><%=cuKey%></aui:option>
								<%  }  %>
								</aui:select>
							</div>
						</div>
					</div>
				
				<% } %>

			</div>
       <aui:button type="submit"/>
</aui:form>

<aui:script use="liferay-auto-fields">
new Liferay.AutoFields({
	contentBox: '#auto-fields-container-tematica',
	fieldIndexes: '<portlet:namespace />rowIndexes',
	on: {
		'clone': function(event) {
		},
		'remove': function(event) {
			
		}
	},
	sortable: false,
	sortableHandle: '.lfr-form-row'
}).render();
</aui:script>
	</c:otherwise>
</c:choose>
